<?xml version="1.0" encoding="utf-8"?>
<Include xmlns="http://schemas.microsoft.com/wix/2006/wi">

  <Binary Id="InstallersDll" SourceFile="$(var.OutputPath)CprBrokerWixInstallers.CA.dll"/>

  <CustomAction Id="TestConnection" BinaryKey="InstallersDll" DllEntry="TestConnectionString" Execute="immediate" Return="check" Impersonate="yes"></CustomAction>
  
  <CustomAction Id="CreateCprBrokerDatabase" BinaryKey="InstallersDll" DllEntry="CreateCprBrokerDatabase" Execute="immediate" Return="check" Impersonate="yes"></CustomAction>
  <CustomAction Id="CreateCprBrokerWebsite" BinaryKey="InstallersDll" DllEntry="CreateCprBrokerWebsite" Execute="immediate" Return="check" Impersonate="no"></CustomAction>
  
  <CustomAction Id="PopulateWebSites" BinaryKey="InstallersDll" DllEntry="PopulateWebSites" Execute="immediate" Return="check" Impersonate="no"></CustomAction>


  <CustomAction Id="ShowSuccess" Execute="immediate" Script="vbscript">
    <![CDATA[msgbox "Succeeded"]]>
  </CustomAction>

  <CustomAction Id="ShowFailure" Execute="immediate" Script="vbscript" >
    <![CDATA[
      msgbox Session.Property("DB_VALID")
    ]]>
  </CustomAction>

  <UI>
    <ComboBox Property="DUMMYPROPERTY">
      <ListItem Text="DUMMYPROPERTY" Value="DUMMYPROPERTY"/>
    </ComboBox>
  </UI>

  <InstallExecuteSequence>

  </InstallExecuteSequence>

  <InstallUISequence>
    <Custom Action="PopulateWebSites" After="CostFinalize"/>
    <Custom Action="CreateCprBrokerDatabase" After="ExecuteAction"/>
    <Custom Action="CreateCprBrokerWebsite" After="CreateCprBrokerDatabase"/>
  </InstallUISequence>

</Include>
