cd \Patch

REM ============
REM Build old project
REM ============

cd OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer

candle.exe -dDebug -dbannerBmp=Bitmaps\bannrbmp.bmp -ddialogBmp=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\dlgbmp.bmp -dexclamationIco=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\exclamic.ico -dinfoIco=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\info.ico -dlicenseRtf=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\license.rtf -dnewIco=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\new.ico -dupIco=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\up.ico -dprinteulaDll=bin\Debug\\PrintEula.dll -dSitePath=..\..\PersonmasterServiceLibrary\ -dOutputPath=..\Output\ -d"DevEnvDir=C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\\" -dSolutionDir=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\ -dSolutionExt=.sln -dSolutionFileName=PersonmasterServiceLibrary.sln -dSolutionName=PersonmasterServiceLibrary -dSolutionPath=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\PersonmasterServiceLibrary.sln -dConfiguration=Debug -dOutDir=bin\Debug\ -dPlatform=x86 -dProjectDir=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\ -dProjectExt=.wixproj -dProjectFileName=Installer.wixproj -dProjectName=Installer -dProjectPath=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Installer.wixproj -dTargetDir=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\ -dTargetExt=.msi -dTargetFileName=PersonMasterInstaller.msi -dTargetName=PersonMasterInstaller -dTargetPath=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\PersonMasterInstaller.msi -dInstallerLib.Configuration=Debug -d"InstallerLib.FullConfiguration=Debug|x86" -dInstallerLib.Platform=x86 -dInstallerLib.ProjectDir=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\ -dInstallerLib.ProjectExt=.csproj -dInstallerLib.ProjectFileName=InstallerLib.csproj -dInstallerLib.ProjectName=InstallerLib -dInstallerLib.ProjectPath=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\InstallerLib.csproj -dInstallerLib.TargetDir=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\bin\Debug\ -dInstallerLib.TargetExt=.dll -dInstallerLib.TargetFileName=PersonMasterInstallers.dll -dInstallerLib.TargetName=PersonMasterInstallers -dInstallerLib.TargetPath=C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\bin\Debug\PersonMasterInstallers.dll -out obj\Debug\ -arch x86 -ext "C:\Program Files\Windows Installer XML v3.5\bin\\WixNetFxExtension.dll" -ext "C:\Program Files\Windows Installer XML v3.5\bin\\WixUIExtension.dll" Customizations.wxs Dialogs.wxs Directories.wxs Files.wxs Product.wxs Conditions.wxs obj\Debug\Product.Generated.wxs

Light.exe -xo -cultures:en-US -ext "C:\Program Files\Windows Installer XML v3.5\bin\\WixNetFxExtension.dll" -ext "C:\Program Files\Windows Installer XML v3.5\bin\\WixUIExtension.dll" -loc en-us.wxl -out C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\en-US\PersonMasterInstaller.msi -pdbout C:\Patch\OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\en-US\PersonMasterInstaller.wixpdb obj\Debug\Customizations.wixobj obj\Debug\Dialogs.wixobj obj\Debug\Directories.wixobj obj\Debug\Files.wixobj obj\Debug\Product.wixobj obj\Debug\Conditions.wixobj obj\Debug\Product.Generated.wixobj C:\Patch\OldSource\Core\Output\WixCommon.wixlib -out bin\Debug\en-US\PersonMasterInstaller.wixout
Light.exe bin\Debug\en-US\PersonMasterInstaller.wixout -out bin\Debug\en-US\PersonMasterInstaller.msi

cd \Patch

REM ============
REM Build new project
REM ============

cd NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer

candle.exe -dDebug -dbannerBmp=Bitmaps\bannrbmp.bmp -ddialogBmp=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\dlgbmp.bmp -dexclamationIco=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\exclamic.ico -dinfoIco=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\info.ico -dlicenseRtf=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\license.rtf -dnewIco=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\new.ico -dupIco=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\up.ico -dprinteulaDll=bin\Debug\\PrintEula.dll -dSitePath=..\..\PersonmasterServiceLibrary\ -dOutputPath=..\Output\ -d"DevEnvDir=C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\\" -dSolutionDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\ -dSolutionExt=.sln -dSolutionFileName=PersonmasterServiceLibrary.sln -dSolutionName=PersonmasterServiceLibrary -dSolutionPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\PersonmasterServiceLibrary.sln -dConfiguration=Debug -dOutDir=bin\Debug\ -dPlatform=x86 -dProjectDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\ -dProjectExt=.wixproj -dProjectFileName=Installer.wixproj -dProjectName=Installer -dProjectPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Installer.wixproj -dTargetDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\ -dTargetExt=.msi -dTargetFileName=PersonMasterInstaller.msi -dTargetName=PersonMasterInstaller -dTargetPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\PersonMasterInstaller.msi -dPersonmasterServiceLibrary.Configuration=Debug -d"PersonmasterServiceLibrary.FullConfiguration=Debug|AnyCPU" -dPersonmasterServiceLibrary.Platform=AnyCPU -dPersonmasterServiceLibrary.ProjectDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\PersonmasterServiceLibrary\ -dPersonmasterServiceLibrary.ProjectExt=.csproj -dPersonmasterServiceLibrary.ProjectFileName=PersonmasterServiceLibrary.csproj -dPersonmasterServiceLibrary.ProjectName=PersonmasterServiceLibrary -dPersonmasterServiceLibrary.ProjectPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\PersonmasterServiceLibrary\PersonmasterServiceLibrary.csproj -dPersonmasterServiceLibrary.TargetDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\PersonmasterServiceLibrary\bin\Debug\ -dPersonmasterServiceLibrary.TargetExt=.dll -dPersonmasterServiceLibrary.TargetFileName=PersonmasterServiceLibrary.dll -dPersonmasterServiceLibrary.TargetName=PersonmasterServiceLibrary -dPersonmasterServiceLibrary.TargetPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\PersonmasterServiceLibrary\bin\Debug\PersonmasterServiceLibrary.dll -dInstallerLib.Configuration=Debug -d"InstallerLib.FullConfiguration=Debug|x86" -dInstallerLib.Platform=x86 -dInstallerLib.ProjectDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\ -dInstallerLib.ProjectExt=.csproj -dInstallerLib.ProjectFileName=InstallerLib.csproj -dInstallerLib.ProjectName=InstallerLib -dInstallerLib.ProjectPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\InstallerLib.csproj -dInstallerLib.TargetDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\bin\Debug\ -dInstallerLib.TargetExt=.dll -dInstallerLib.TargetFileName=PersonMasterInstallers.dll -dInstallerLib.TargetName=PersonMasterInstallers -dInstallerLib.TargetPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\bin\Debug\PersonMasterInstallers.dll -out obj\Debug\ -arch x86 -ext "C:\Program Files\Windows Installer XML v3.5\bin\\WixNetFxExtension.dll" -ext "C:\Program Files\Windows Installer XML v3.5\bin\\WixUIExtension.dll" Customizations.wxs Dialogs.wxs Directories.wxs Files.wxs Product.wxs Conditions.wxs obj\Debug\Product.Generated.wxs

candle.exe -dDebug -dbannerBmp=Bitmaps\bannrbmp.bmp -ddialogBmp=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\dlgbmp.bmp -dexclamationIco=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\exclamic.ico -dinfoIco=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\info.ico -dlicenseRtf=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\license.rtf -dnewIco=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\new.ico -dupIco=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Bitmaps\up.ico -dprinteulaDll=bin\Debug\\PrintEula.dll -dSitePath=..\..\PersonmasterServiceLibrary\ -dOutputPath=..\Output\ -d"DevEnvDir=C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\\" -dSolutionDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\ -dSolutionExt=.sln -dSolutionFileName=PersonmasterServiceLibrary.sln -dSolutionName=PersonmasterServiceLibrary -dSolutionPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\PersonmasterServiceLibrary.sln -dConfiguration=Debug -dOutDir=bin\Debug\ -dPlatform=x86 -dProjectDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\ -dProjectExt=.wixproj -dProjectFileName=Installer.wixproj -dProjectName=Installer -dProjectPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\Installer.wixproj -dTargetDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\ -dTargetExt=.msi -dTargetFileName=PersonMasterInstaller.msi -dTargetName=PersonMasterInstaller -dTargetPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\PersonMasterInstaller.msi -dPersonmasterServiceLibrary.Configuration=Debug -d"PersonmasterServiceLibrary.FullConfiguration=Debug|AnyCPU" -dPersonmasterServiceLibrary.Platform=AnyCPU -dPersonmasterServiceLibrary.ProjectDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\PersonmasterServiceLibrary\ -dPersonmasterServiceLibrary.ProjectExt=.csproj -dPersonmasterServiceLibrary.ProjectFileName=PersonmasterServiceLibrary.csproj -dPersonmasterServiceLibrary.ProjectName=PersonmasterServiceLibrary -dPersonmasterServiceLibrary.ProjectPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\PersonmasterServiceLibrary\PersonmasterServiceLibrary.csproj -dPersonmasterServiceLibrary.TargetDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\PersonmasterServiceLibrary\bin\Debug\ -dPersonmasterServiceLibrary.TargetExt=.dll -dPersonmasterServiceLibrary.TargetFileName=PersonmasterServiceLibrary.dll -dPersonmasterServiceLibrary.TargetName=PersonmasterServiceLibrary -dPersonmasterServiceLibrary.TargetPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\PersonmasterServiceLibrary\bin\Debug\PersonmasterServiceLibrary.dll -dInstallerLib.Configuration=Debug -d"InstallerLib.FullConfiguration=Debug|x86" -dInstallerLib.Platform=x86 -dInstallerLib.ProjectDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\ -dInstallerLib.ProjectExt=.csproj -dInstallerLib.ProjectFileName=InstallerLib.csproj -dInstallerLib.ProjectName=InstallerLib -dInstallerLib.ProjectPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\InstallerLib.csproj -dInstallerLib.TargetDir=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\bin\Debug\ -dInstallerLib.TargetExt=.dll -dInstallerLib.TargetFileName=PersonMasterInstallers.dll -dInstallerLib.TargetName=PersonMasterInstallers -dInstallerLib.TargetPath=C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\InstallerLib\bin\Debug\PersonMasterInstallers.dll -out obj\Debug\Patch\ -arch x86 -ext "C:\Program Files\Windows Installer XML v3.5\bin\\WixNetFxExtension.dll" -ext "C:\Program Files\Windows Installer XML v3.5\bin\\WixUIExtension.dll" Patch\DatabasePatch.wxs

Light.exe -xo -cultures:en-US -ext "C:\Program Files\Windows Installer XML v3.5\bin\\WixNetFxExtension.dll" -ext "C:\Program Files\Windows Installer XML v3.5\bin\\WixUIExtension.dll" -loc en-us.wxl -out C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\en-US\PersonMasterInstaller.msi -pdbout C:\Patch\NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\en-US\PersonMasterInstaller.wixpdb obj\Debug\Customizations.wixobj obj\Debug\Dialogs.wixobj obj\Debug\Directories.wixobj obj\Debug\Files.wixobj obj\Debug\Patch\DatabasePatch.wixobj obj\Debug\Product.wixobj obj\Debug\Conditions.wixobj obj\Debug\Product.Generated.wixobj C:\Patch\NewSource\Core\Output\WixCommon.wixlib -out bin\Debug\en-US\PersonMasterInstaller.wixout

Light.exe bin\Debug\en-US\PersonMasterInstaller.wixout -out bin\Debug\en-US\PersonMasterInstaller.msi

cd \Patch

REM ============
REM Build the patch
REM ============

candle Patch_Wix.wxs -out Patch_Wix.wixobj

light Patch_Wix.wixobj -out Patch_Wix.wixmsp

rem light Patch_Wix.wixobj -out Patch_Wix.wixout -xo -b NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\
rem light Patch_Wix.wixout -out Patch_Wix.wixmsp

torch -p -xi OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\en-US\PersonMasterInstaller.wixpdb NewSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer\bin\Debug\en-US\PersonMasterInstaller.wixpdb -out Patch_Wix.wixmst

cd OldSource\GK.WebServices\Personmaster\PersonmasterServiceLibrary\Deploy\Installer
pyro C:\Patch\Patch_Wix.wixmsp -t MyPatch C:\Patch\Patch_Wix.wixmst -out C:\Patch\Patch_Wix.msp
cd \Patch